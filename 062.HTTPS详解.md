### 什么是`HTTPS`
`HTTP`协议上嵌套了一层`SSL(Secure Socket Layer)`层，来进行`HTTPS`通信

### 普通`HTTP`协议的风险
(1) **窃听风险**（eavesdropping): 第三方可以获知通信内容。
(2) **篡改风险**(tampering): 第三方可以修改通信内容。
(3) **冒充风险** (pretending): 第三方可以冒充他人身份参与通信。

### `SSL/TLS`通信的作用
(1) 所有信息都是**加密传播**，第三方无法窃听。
(2) 具有**检验机制**，一旦被篡改，通信双方会立刻发现。
(3) 配备**身份证书**，防止身份被冒充。

### `HTTPS`通信过程如图所示
![HTTPS通信过程](images/HTTPS通信过程.png)

1. 首先，客户端向服务器端请求公钥，这个过程中，客户端主要向服务器端提供以下信息：
```
（1） 支持的协议版本，比如TLS 1.0版。

（2） 一个客户端生成的随机数，稍后用于生成"对话密钥"。

（3） 支持的加密方法，比如RSA公钥加密。

（4） 支持的压缩方法。
```

2. 服务器回应
服务器给客户端包含公钥的证书，这个过程中，服务器端主要向客户端提供以下信息：
```
（1） 确认使用的加密通信协议版本，比如TLS 1.0版本。如果浏览器与服务器支持的版本不一致，服务器关闭加密通信。

（2） 一个服务器生成的随机数，稍后用于生成"对话密钥"。

（3） 确认使用的加密方法，比如RSA公钥加密。

（4） 服务器证书
```

3. 客户端响应
客户端收到响应，先验证证书，证书有问题，显示警告，证书没有问题，取出公钥，然后向服务器发送用公钥加密的信息（这个公钥加密的信息，只有服务器的私钥能够解开）。客户端向服务器发送下面三项信息：
```
（1） 一个随机数。该随机数用服务器公钥加密，防止被窃听。

（2） 编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送。

（3） 客户端握手结束通知，表示客户端的握手阶段已经结束。这一项同时也是前面发送的所有内容的hash值，用来供服务器校验。
```

4. 服务器的最后响应
服务器用私钥解开客户端响应的随机数，计算生成本次会话的秘钥，用于本次会话服务器端与客户端的通信。最后一次握手向客户端发送的信息如下：
```
（1）编码改变通知，表示随后的信息都将用双方商定的加密方法和密钥发送。

（2）服务器握手结束通知，表示服务器的握手阶段已经结束。这一项同时也是前面发送的所有内容的hash值，用来供客户端校验。
```